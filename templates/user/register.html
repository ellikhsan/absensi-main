<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registrasi Siswa</title>
    <style>
        /* CSS tetap sama, tidak aku ubah */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background: #f5f5f5;
            color: #333;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            padding: 40px;
            width: 100%;
            max-width: 500px;
            border: 1px solid #ddd;
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.2em;
            font-weight: 300;
        }
        .form-group { margin-bottom: 25px; }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #666;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .required { color: #dc3545; }
        input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            background: #f8f9fa;
        }
        input[type="text"]:focus {
            outline: none;
            border-color: #007bff;
            box-shadow: 0 0 0 3px rgba(0,123,255,0.1);
            background: white;
        }
        .radio-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 8px;
        }
        .radio-item {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            background: #f8f9fa;
            transition: all 0.3s ease;
        }
        .radio-item:hover { border-color: #007bff; background: rgba(0,123,255,0.05); }
        .submit-btn {
            width: 100%;
            padding: 16px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .submit-btn:hover:not(:disabled) {
            background: #0056b3;
            transform: translateY(-2px);
        }
        .submit-btn:disabled { background: #6c757d; cursor: not-allowed; }
        .error { color: #dc3545; font-size: 14px; margin-top: 5px; display: none; }
        .error.show { display: block; }
        .back-link { text-align: center; margin-top: 25px; }
        .back-link a { color: #007bff; text-decoration: none; }
    </style>
</head>
<body>
<div class="container">
    <h1>üë§ Registrasi Siswa</h1>

    <!-- Flash Messages Flask -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="flash-messages">
        {% for category, message in messages %}
        <div class="flash-message flash-{{ category }}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <form id="registerForm" action="{{ url_for('register_user') }}" method="POST">
        <div class="form-group">
            <label for="nama">Nama Lengkap <span class="required">*</span></label>
            <input type="text" id="nama" name="nama" required placeholder="Masukkan nama lengkap siswa">
            <div class="error" id="nama-error">Nama harus diisi!</div>
        </div>

        <div class="form-group">
            <label>Kelas <span class="required">*</span></label>
            <div class="radio-group">
                <label class="radio-item"><input type="radio" name="kelas" value="X" required> Kelas X</label>
                <label class="radio-item"><input type="radio" name="kelas" value="XI" required> Kelas XI</label>
                <label class="radio-item"><input type="radio" name="kelas" value="XII" required> Kelas XII</label>
            </div>
            <div class="error" id="kelas-error">Pilih kelas terlebih dahulu!</div>
        </div>

        <div class="form-group">
            <label>Jurusan <span class="required">*</span></label>
            <div class="radio-group" id="jurusan-group">
                <div class="radio-item" data-jurusan="SIJA">SIJA</div>
                <div class="radio-item" data-jurusan="DKV">DKV</div>
                <div class="radio-item" data-jurusan="PB">PB</div>
            </div>
        </div>

        <div class="form-group" id="subkelas-container" style="display:none;">
            <label>Sub-Kelas <span class="required">*</span></label>
            <div id="subkelas-buttons"></div>
        </div>

        <!-- Hidden input untuk simpan pilihan -->
        <input type="hidden" name="jurusan" id="jurusan-input" required>
        <input type="hidden" name="subkelas" id="subkelas-input" required>

        <button type="submit" class="submit-btn" id="submitBtn">üìù Daftarkan Siswa</button>
    </form>

    <div class="back-link">
        <a href="{{ url_for('index') }}">‚Üê Kembali ke Beranda</a>
    </div>
</div>

<script>
const jurusanItems = document.querySelectorAll('#jurusan-group .radio-item');
const subkelasContainer = document.getElementById('subkelas-container');
const subkelasButtons = document.getElementById('subkelas-buttons');
const jurusanInput = document.getElementById('jurusan-input');
const subkelasInput = document.getElementById('subkelas-input');

let selectedJurusan = '';
let selectedSubkelas = '';

const subkelasOptions = {
    'SIJA': ['SIJA 1','SIJA 2','SIJA 3'],
    'DKV': ['DKV 1','DKV 2','DKV 3'],
    'PB': ['PB 1','PB 2','PB 3']
};

function resetJurusan() {
    jurusanItems.forEach(i => {
        i.textContent = i.dataset.jurusan;
        i.style.background = '#f8f9fa';
    });
    subkelasContainer.style.display = 'none';
    subkelasButtons.innerHTML = '';
    selectedJurusan = '';
    selectedSubkelas = '';
    jurusanInput.value = '';
    subkelasInput.value = '';
}

jurusanItems.forEach(item => {
    item.addEventListener('click', function() {
        resetJurusan();
        selectedJurusan = this.dataset.jurusan;
        jurusanInput.value = selectedJurusan; // simpan hidden jurusan
        this.style.background = 'rgba(0,123,255,0.1)';

        subkelasContainer.style.display = 'block';
        subkelasOptions[selectedJurusan].forEach(sub => {
            const btn = document.createElement('button');
            btn.type = 'button';
            btn.textContent = sub;
            btn.style.margin = '5px';
            btn.style.padding = '8px 16px';
            btn.style.border = '1px solid #007bff';
            btn.style.borderRadius = '5px';
            btn.style.background = '#f8f9fa';
            btn.style.cursor = 'pointer';

            btn.addEventListener('click', () => {
    subkelasButtons.querySelectorAll('button').forEach(b => b.style.background = '#f8f9fa');
    btn.style.background = 'rgba(0,123,255,0.1)';
    selectedSubkelas = sub;

    // Simpan jurusan langsung sesuai subkelas (misal "DKV 2")
    jurusanInput.value = selectedSubkelas;
    subkelasInput.value = selectedSubkelas;

    item.textContent = selectedSubkelas;
});

            subkelasButtons.appendChild(btn);
        });
    });
});

const form = document.getElementById('registerForm');
const submitBtn = document.getElementById('submitBtn');
const namaInput = document.getElementById('nama');

form.addEventListener('submit', function(e) {
    if (namaInput.value.trim() === '' || jurusanInput.value === '' || subkelasInput.value === '') {
        e.preventDefault();
        alert('‚ùå Mohon lengkapi semua field yang wajib diisi!');
        return false;
    }
    submitBtn.disabled = true;
    submitBtn.innerHTML = '‚è≥ Memproses...';
});
</script>
</body>
</html>
